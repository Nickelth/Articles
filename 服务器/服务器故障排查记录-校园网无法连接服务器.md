这几天忽然遇到一个很奇怪的问题：用有线网和校内VPN可以连上服务器，但是用校园网wifi不行。

首先尝试在客户端（windows）ping服务器公网ip，能ping通。

然后用telnet ip_address port，看一下端口开没开，发现没有回应。

用有线网登录服务器，用ufw status查看一下防火墙状态，是关闭的，所以也不是防火墙的问题。

然后用netstat -nlp | grep LISTEN查看所有正在监听的端口，ssh服务的22端口也是在正常监听的。

到这一步有些迷惑了，问了机房和网络中心，都说没有异常。

最后，问了下隔壁组的学长：

先用ip route查看静态路由表：

![image-20240427235742595](D:\Articles\img\image-20240427235742595.png)

发现其中有两条路由显示linkdown。

在客户端使用ipconfig查看ip地址：

![image-20240427235906657](D:\Articles\img\image-20240427235906657.png)

发现，校园网的ip网段就在172.18底下。

路由表里那条对应记录的意思是：所有发往172.18.0.0/16网段也就是校园网的网络包，都从这条路由走，但现在这条路由linkdown了，所以就发不出去了。

解决方法是，用ip route del 172.18.0.0/16 dev br-8015447bc2a0 proto kernel scope link src 172.18.0.1删除这个路由，这样网络包就会走默认的路由，也就是第一条10.10.62.0/24，这样就没有问题了。



